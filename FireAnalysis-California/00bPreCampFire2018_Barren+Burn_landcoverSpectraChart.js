/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var Barren1_CitySouth = 
    /* color: #d63000 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[-121.77292357891315, 39.70158600648374],
              [-121.77292357891315, 39.69828409870127],
              [-121.75446998089069, 39.69828409870127],
              [-121.75446998089069, 39.70158600648374]]], null, false),
        {
          "system:index": "0",
          "label": "Barren1"
        }),
    Barren2_CityEast = 
    /* color: #98ff00 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[-121.55631043096798, 39.757022811291996],
              [-121.55631043096798, 39.75501028525689],
              [-121.55407883306759, 39.75501028525689],
              [-121.55407883306759, 39.757022811291996]]], null, false),
        {
          "system:index": "0",
          "label": "Barren2"
        }),
    Barren3_CityNorth = /* color: #0b4a8b */ee.Feature(
        ee.Geometry.Polygon(
            [[[-121.57810538482642, 39.80811094213714],
              [-121.57806246948218, 39.80805324940312],
              [-121.57804101181006, 39.80795434746071],
              [-121.57804637622809, 39.807871929066685],
              [-121.5779766387937, 39.80779363150083],
              [-121.57792835903143, 39.80778538964664],
              [-121.57789080810522, 39.807690608252045],
              [-121.57788007926916, 39.80757110109002],
              [-121.57778351974463, 39.80757522203009],
              [-121.57775669765448, 39.80769885011764],
              [-121.57768159580206, 39.80780187335408],
              [-121.57753675651526, 39.807805994280336],
              [-121.57754748535132, 39.80788841275339],
              [-121.57750993442511, 39.80796671021131],
              [-121.57746165466284, 39.80804500758002],
              [-121.57745629024481, 39.80811094213714],
              [-121.57740264606451, 39.808230448360774],
              [-121.57730608653998, 39.80823869016164],
              [-121.57732217979407, 39.80830462453304],
              [-121.5774723834989, 39.80833759169501],
              [-121.57768696022009, 39.808316987220614],
              [-121.57782107067084, 39.80830874542914],
              [-121.57792835903143, 39.80830462453304],
              [-121.57805174064612, 39.80828402004877],
              [-121.57810538482642, 39.80820572295224]]]),
        {
          "system:index": "0",
          "label": "Barren3"
        }),
    Barren4_CityWest = /* color: #00ffff */ee.Feature(
        ee.Geometry.Polygon(
            [[[-121.63688935419339, 39.7555194909516],
              [-121.636460200751, 39.75528854328715],
              [-121.63214720865506, 39.75802687289254],
              [-121.63270510813015, 39.758307298092035]]]),
        {
          "label": "Barren4",
          "system:index": "0"
        }),
    Trees1_CityNorth = 
    /* color: #ffc82d */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[-121.57400228163021, 39.79432018722106],
              [-121.57400228163021, 39.793161970113196],
              [-121.572704092467, 39.793161970113196],
              [-121.572704092467, 39.79432018722106]]], null, false),
        {
          "system:index": "0",
          "label": "Tree1"
        }),
    Trees2_CitySouth = 
    /* color: #bf04c2 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[-121.59785065114909, 39.747616983858165],
              [-121.59785065114909, 39.747225152237036],
              [-121.59670803010874, 39.747225152237036],
              [-121.59670803010874, 39.747616983858165]]], null, false),
        {
          "system:index": "0",
          "label": "Tree2"
        }),
    Trees3_CityEast = 
    /* color: #ff0000 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[-121.5703875130456, 39.7538220622707],
              [-121.5703875130456, 39.7520239049731],
              [-121.56624618232661, 39.7520239049731],
              [-121.56624618232661, 39.7538220622707]]], null, false),
        {
          "system:index": "0",
          "label": "Tree3"
        }),
    Trees4_CityWest = /* color: #00ff00 */ee.Feature(
        ee.Geometry.Polygon(
            [[[-121.60107466638499, 39.78060739641416],
              [-121.60026463926249, 39.78120104191407],
              [-121.60057041109019, 39.781431902669866],
              [-121.60134288728648, 39.78092483249213]]]),
        {
          "system:index": "0",
          "label": "Tree4"
        }),
    House1_CityWest = /* color: #0000ff */ee.Feature(
        ee.Geometry.Polygon(
            [[[-121.59363181242111, 39.78358725313203],
              [-121.59344405779007, 39.78359137550936],
              [-121.59342796453598, 39.78325333974795],
              [-121.59203858026626, 39.78321623816079],
              [-121.59201712259414, 39.78244534510178],
              [-121.59030050882461, 39.782478324660815],
              [-121.59030050882461, 39.78465494060938],
              [-121.59351915964248, 39.78460547282974]]]),
        {
          "system:index": "0",
          "label": "House1"
        }),
    House2_CityNorth = 
    /* color: #009999 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[-121.58405364402893, 39.79771063147241],
              [-121.58405364402893, 39.796698788122534],
              [-121.58215195783737, 39.796698788122534],
              [-121.58215195783737, 39.79771063147241]]], null, false),
        {
          "system:index": "0",
          "label": "House2"
        }),
    House3_CitySouth = 
    /* color: #ff00ff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[-121.60642058500412, 39.745899971758774],
              [-121.60642058500412, 39.743689132231154],
              [-121.60535843023422, 39.743689132231154],
              [-121.60535843023422, 39.745899971758774]]], null, false),
        {
          "system:index": "0",
          "label": "House3"
        }),
    House4_CityEast = /* color: #ff9999 */ee.Feature(
        ee.Geometry.Polygon(
            [[[-121.5733328545964, 39.761279016792834],
              [-121.57323629507187, 39.76100685115427],
              [-121.57051117071273, 39.76090375782848],
              [-121.57038778909805, 39.76112231549594],
              [-121.57050044187667, 39.761452212548214],
              [-121.57214731821182, 39.76191818944177],
              [-121.57230825075271, 39.761629531560764],
              [-121.5727374041951, 39.7613120064941]]]),
        {
          "system:index": "0",
          "label": "House4"
        }),
    Community_Park = /* color: #bf04c2 */ee.Feature(
        ee.Geometry.Polygon(
            [[[-121.62440152502467, 39.75246215570849],
              [-121.62330718374659, 39.754375777218804],
              [-121.62255616522242, 39.754128329154184],
              [-121.6236505065005, 39.75216520967495],
              [-121.62440152502467, 39.75246215570849]]]),
        {
          "label": "Community Park",
          "system:index": "0"
        }),
    Bille_Park = 
    /* color: #ffc82d */
    /* displayProperties: [
      {
        "type": "marker"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      },
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry({
          "type": "GeometryCollection",
          "geometries": [
            {
              "type": "Point",
              "coordinates": [
                -121.6333,
                39.77503
              ]
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    -121.63560051613365,
                    39.7773042987354
                  ],
                  [
                    -121.63560051613365,
                    39.7748470935795
                  ],
                  [
                    -121.63228530579124,
                    39.7748470935795
                  ],
                  [
                    -121.63228530579124,
                    39.7773042987354
                  ]
                ]
              ],
              "geodesic": false,
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    -121.63556832962547,
                    39.77486358518166
                  ],
                  [
                    -121.63556832962547,
                    39.773222651402136
                  ],
                  [
                    -121.63322944336448,
                    39.773222651402136
                  ],
                  [
                    -121.63322944336448,
                    39.77486358518166
                  ]
                ]
              ],
              "geodesic": false,
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    -121.63284320526634,
                    39.772958779002636
                  ],
                  [
                    -121.63284320526634,
                    39.770649852358616
                  ],
                  [
                    -121.63201708488975,
                    39.770649852358616
                  ],
                  [
                    -121.63201708488975,
                    39.772958779002636
                  ]
                ]
              ],
              "geodesic": false,
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    -121.63308996849571,
                    39.77354424452139
                  ],
                  [
                    -121.63308996849571,
                    39.77333809525885
                  ],
                  [
                    -121.6318990676931,
                    39.77333809525885
                  ],
                  [
                    -121.6318990676931,
                    39.77354424452139
                  ]
                ]
              ],
              "geodesic": false,
              "evenOdd": true
            }
          ],
          "coordinates": []
        }),
        {
          "label": "Bille Park",
          "system:index": "0"
        }),
    Aquatic_Memorial_Park = 
    /* color: #07e8ff */
    /* displayProperties: [
      {
        "type": "rectangle"
      },
      {
        "type": "marker"
      },
      {
        "type": "marker"
      },
      {
        "type": "marker"
      },
      {
        "type": "marker"
      }
    ] */
    ee.Feature(
        ee.Geometry({
          "type": "GeometryCollection",
          "geometries": [
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    -121.61444307919567,
                    39.751852734820844
                  ],
                  [
                    -121.61444307919567,
                    39.75012876501868
                  ],
                  [
                    -121.6136384164912,
                    39.75012876501868
                  ],
                  [
                    -121.6136384164912,
                    39.751852734820844
                  ]
                ]
              ],
              "geodesic": false,
              "evenOdd": true
            },
            {
              "type": "Point",
              "coordinates": [
                -121.61346675511425,
                39.75019475508752
              ]
            },
            {
              "type": "Point",
              "coordinates": [
                -121.61382080670421,
                39.74990604806971
              ]
            },
            {
              "type": "Point",
              "coordinates": [
                -121.6145932829005,
                39.74979881372638
              ]
            },
            {
              "type": "Point",
              "coordinates": [
                -121.61461474057262,
                39.75053295319813
              ]
            }
          ],
          "coordinates": []
        }),
        {
          "label": "Aquatic (Memorial) Park",
          "system:index": "0"
        });
/***** End of imports. If edited, may not auto-convert in the playground. *****/
// Import the primary region of interest, Town of Paradise which burned in the Camp Fire of 2018.
var Paradise = ee.FeatureCollection("ft:1JIO1SLcMe08lHJWUIP7zWpW5razN6FfIwibHtcje").geometry();

//Center Map
Map.centerObject(Paradise, 10);

// We use a LANDSAT 8 image from six months before the fire (June 1, 2018).
var image = ee.Image("LANDSAT/LC08/C01/T1_SR/LC08_044032_20180601")
    .select(["B[1-7]"]);
Map.addLayer(image, {bands: ["B4", "B3", "B2"], min: 0, max: 2000}, "Landsat");

// Define and display a FeatureCollection of three known locations.
var all_points = ee.FeatureCollection([
  Barren1_CitySouth,
  Barren2_CityEast,
  Barren3_CityNorth,
  Barren4_CityWest,
  Trees1_CityNorth,
  Trees2_CitySouth,
  Trees3_CityEast,
  Trees4_CityWest,
  House1_CityWest,
  House2_CityNorth,
  House3_CitySouth,
  House4_CityEast,
  // Community_Park,
  // Bille_Park,
  // Aquatic_Memorial_Park,
]);

var sample_points = ee.FeatureCollection([
  Barren1_CitySouth,
  Trees3_CityEast,
  House2_CityNorth,
]);

var barren_points = ee.FeatureCollection([
  Barren1_CitySouth,
  Barren2_CityEast,
  Barren3_CityNorth,
  Barren4_CityWest,
]);

var tree_points = ee.FeatureCollection([
  Trees1_CityNorth,
  Trees2_CitySouth,
  Trees3_CityEast,
  Trees4_CityWest,
]);

var house_points = ee.FeatureCollection([
  House1_CityWest,
  House2_CityNorth,
  House3_CitySouth,
  House4_CityEast,
]);

// Define customization options for an all chart
var all_options = {
  title: "Landsat 8 SR spectra comparison for barren land vs trees and houses in the Town of Paradise, Post-Fire",
  hAxis: {title: "Wavelength (micrometers)"},
  vAxis: {title: "Reflectance"},
  lineWidth: 1,
  pointSize: 4,
  min: 0,
  max: 4000,
};

// Define a list of Landsat 8 wavelengths for X-axis labels.
var wavelengths = [0.44, 0.48, 0.56, 0.65, 0.86, 1.61, 2.2];

// Create the chart and set options.
var all_spectraChart = ui.Chart.image.regions(
    image, all_points, ee.Reducer.mean(), 30, "label", wavelengths)
        .setChartType("ScatterChart")
        .setOptions(all_options);

// Display the chart in Console.
print(all_spectraChart);

// Define customization options for a barren land chart
var barren_options = {
  title: "Landsat 8 SR spectra comparison for barren land regions in the Town of Paradise, Post-Fire",
  hAxis: {title: "Wavelength (micrometers)"},
  vAxis: {title: "Reflectance"},
  lineWidth: 1,
  pointSize: 4,
  min: 0,
  max: 4000,
};

// Define a list of Landsat 8 wavelengths for X-axis labels.
var wavelengths = [0.44, 0.48, 0.56, 0.65, 0.86, 1.61, 2.2];

// Create the chart and set options.
var barren_spectraChart = ui.Chart.image.regions(
    image, barren_points, ee.Reducer.mean(), 30, "label", wavelengths)
        .setChartType("ScatterChart")
        .setOptions(barren_options);

// Display the chart in Console.
print(barren_spectraChart);

// Define customization options for a charred trees land chart
var tree_options = {
  title: "Landsat 8 SR spectra comparison for regions with trees in the Town of Paradise, Post-Fire",
  hAxis: {title: "Wavelength (micrometers)"},
  vAxis: {title: "Reflectance"},
  lineWidth: 1,
  pointSize: 4,
  min: 0,
  max: 4000,
};

// Define a list of Landsat 8 wavelengths for X-axis labels.
var wavelengths = [0.44, 0.48, 0.56, 0.65, 0.86, 1.61, 2.2];

// Create the chart and set options.
var tree_spectraChart = ui.Chart.image.regions(
    image, tree_points, ee.Reducer.mean(), 30, "label", wavelengths)
        .setChartType("ScatterChart")
        .setOptions(tree_options);

// Display the chart in Console.
print(tree_spectraChart);

// Define customization options for a burned homes and buildings land chart
var house_options = {
  title: "Landsat 8 SR spectra comparison for regions with buildings and structures in the Town of Paradise, Post-Fire",
  hAxis: {title: "Wavelength (micrometers)"},
  vAxis: {title: "Reflectance"},
  lineWidth: 1,
  pointSize: 4,
  min: 0,
  max: 4000,
};

// Define a list of Landsat 8 wavelengths for X-axis labels.
var wavelengths = [0.44, 0.48, 0.56, 0.65, 0.86, 1.61, 2.2];

// Create the chart and set options.
var house_spectraChart = ui.Chart.image.regions(
    image, house_points, ee.Reducer.mean(), 30, "label", wavelengths)
        .setChartType("ScatterChart")
        .setOptions(house_options);

// Display the chart in Console.
print(house_spectraChart);

// Define customization options for a small single-sample of one per type chart
var sample_options = {
  title: "Landsat 8 SR spectrum comparison for trees/buildings and already barren land in the Town of Paradise, Post-Fire",
  hAxis: {title: "Wavelength (micrometers)"},
  vAxis: {title: "Reflectance"},
  lineWidth: 1,
  pointSize: 4,
  min: 0,
  max: 4000,
};

// Define a list of Landsat 8 wavelengths for X-axis labels.
var wavelengths = [0.44, 0.48, 0.56, 0.65, 0.86, 1.61, 2.2];

// Create the chart and set options.
var sample_spectraChart = ui.Chart.image.regions(
    image, sample_points, ee.Reducer.mean(), 30, "label", wavelengths)
        .setChartType("ScatterChart")
        .setOptions(sample_options);

// Display the chart in Console.
print(sample_spectraChart);

Export.table.toDrive({
  collection: all_points,
  description: "ParadiseTrainingPolygons",
  folder: "California-Paradise_CampFire2018",
  fileNamePrefix:"Paradise_Training_Polygons",
  fileFormat:"KML"
});